import{ad as he,e as h,i as s,g as l,S as w,l as u,c as z,ae as $e,h as G,F as re,j as ae,t as L,b as q,z as fe,u as xe,af as J,ag as K,f as ve}from"./vendor-9d884d62.js";import{B as A}from"./Button-2f123a88.js";import{r as be,P as pe,p as Y,j as U,k as Q,l as _,L as ie,m as Z,n as ee,h as _e,o as te}from"./index-8abaf42d.js";import{u as F}from"./global-c5bd22bb.js";const we=u('<div class="ml-2 flex flex-1 flex-col">'),ye=u('<div class="flex"><div class="flex flex-1 flex-col">'),ne=e=>{const r=he(),n=h(()=>r.width>=640&&be()),o=h(()=>e.subChild.filter((c,g)=>g%2===0||!n())),i=h(()=>e.subChild.filter((c,g)=>g%2===1));return(()=>{const c=ye(),g=c.firstChild;return s(g,o),s(c,l(w,{get when(){return n()},get children(){const C=we();return s(C,i),C}}),null),c})()},le=e=>{const[r,n]=z(100),o=h(()=>e.proxyNames.slice(0,r()));return l($e,{get each(){return o()},get hasMore(){return o().length<e.proxyNames.length},next:()=>n(r()+30),children:i=>l(pe,{proxyName:i,get isSelected(){return e.now===i},get onClick(){return e.onClick?()=>{var c;return(c=e.onClick)==null?void 0:c.call(e,i)}:void 0}})})},se=e=>{const r=()=>Y()===U.OFF,n=h(()=>e.proxyNameList.length<=30),o=h(()=>{const c=Y();return c===U.BAR||c===U.Auto&&!n()}),i=h(()=>{const c=Y();return c===U.DOTS||c===U.Auto&&n()});return l(w,{get when(){return!r()},get children(){return[l(w,{get when(){return o()},get children(){return l(Se,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}}),l(w,{get when(){return i()},get children(){return l(ke,{get proxyNameList(){return e.proxyNameList},get now(){return e.now}})}})]}})},Ce=u('<div class="flex h-6 w-full items-center gap-2"><div class="flex flex-1 overflow-hidden rounded-2xl"><div class="h-2 bg-success"></div><div class="h-2 bg-warning"></div><div class="h-2 bg-error"></div><div class="h-2 bg-neutral">'),Se=e=>{const{latencyMap:r}=Q(),n=h(()=>e.proxyNameList.map(d=>r()[d])),o=h(()=>n().length),i=h(()=>n().filter(d=>d>_().NOT_CONNECTED&&d<=_().MEDIUM).length),c=h(()=>n().filter(d=>d>_().MEDIUM&&d<=_().HIGH).length),g=h(()=>n().filter(d=>d>_().HIGH).length),C=h(()=>n().filter(d=>d===_().NOT_CONNECTED).length);return(()=>{const d=Ce(),S=d.firstChild,N=S.firstChild,P=N.nextSibling,D=P.nextSibling,H=D.nextSibling;return s(d,l(ie,{get name(){return e.now}}),null),G(f=>{const M=`${i()*100/o()}%`,I=`${c()*100/o()}%`,k=`${g()*100/o()}%`,O=`${C()*100/o()}%`;return M!==f._v$&&((f._v$=M)!=null?N.style.setProperty("width",M):N.style.removeProperty("width")),I!==f._v$2&&((f._v$2=I)!=null?P.style.setProperty("width",I):P.style.removeProperty("width")),k!==f._v$3&&((f._v$3=k)!=null?D.style.setProperty("width",k):D.style.removeProperty("width")),O!==f._v$4&&((f._v$4=O)!=null?H.style.setProperty("width",O):H.style.removeProperty("width")),f},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),d})()},Ne=u("<div>"),Pe=u('<div class="flex items-center gap-2"><div class="flex flex-1 flex-wrap items-center">'),Me=e=>{let r=e.selected?"bg-white border-4 border-success":"bg-success";return typeof e.latency!="number"||e.latency===_().NOT_CONNECTED?r=e.selected?"bg-white border-4 border-neutral":"bg-neutral":e.latency>_().HIGH?r=e.selected?"bg-white border-4 border-error":"bg-error":e.latency>_().MEDIUM&&(r=e.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{const n=Ne();return G(()=>ae(n,L("m-1 h-4 w-4 rounded-full",r))),n})()},ke=e=>{const{latencyMap:r}=Q();return(()=>{const n=Pe(),o=n.firstChild;return s(o,l(re,{get each(){return e.proxyNameList.map(i=>[i,r()[i]])},children:([i,c])=>{const g=e.now===i;return l(Me,{latency:c,selected:g})}})),s(n,l(ie,{get name(){return e.now}}),null),n})()},Te=u('<progress class="progress" max="100">'),Ee=u('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),Le=u('<div class="text-sm text-slate-500">Expire: <!> '),De=e=>{const r=q(e.Total,{units:"iec"}),n=q(e.Download+e.Upload,{units:"iec"}),o=((e.Download+e.Upload)/e.Total*100).toFixed(2);return{total:r,used:n,percentage:o,expireStr:()=>e.Expire===0?"Null":fe(e.Expire*1e3).format("YYYY-MM-DD")}},Ie=e=>{if(!e.subscriptionInfo)return;const r=De(e.subscriptionInfo);return[(()=>{const n=Te();return G(()=>n.value=r.percentage),n})(),(()=>{const n=Ee(),o=n.firstChild,i=o.nextSibling,c=i.nextSibling,g=c.nextSibling;return g.nextSibling,s(n,()=>`${r.used}`,o),s(n,()=>`${r.total}`,i),s(n,()=>r.percentage,g),n})(),(()=>{const n=Le(),o=n.firstChild,i=o.nextSibling;return i.nextSibling,s(n,()=>r.expireStr(),i),n})()]},Oe=u('<div class="divider">'),Be=u('<div class="flex h-full flex-col gap-2"><div class="flex items-center justify-between gap-2"><div class="tabs-boxed tabs gap-2"></div></div><div class="flex-1 overflow-y-auto">'),Ue=u('<button><span></span><div class="badge badge-sm">'),He=u('<div class="mr-8 flex items-center justify-between"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div>'),Ae=u('<div class="text-sm text-slate-500"> :: <!> '),Fe=u('<div class="mr-8 flex items-center justify-between"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm">'),Ge=u('<div class="text-sm text-slate-500"> ');var b=function(e){return e.all="all",e.proxyProviders="proxyProviders",e.proxies="proxies",e}(b||{});const ze=()=>{const[e]=xe(),{proxies:r,setProxyGroupByProxyName:n,latencyTestByProxyGroupName:o,latencyMap:i,proxyProviders:c,updateProviderByProviderName:g,updateAllProvider:C,healthCheckByProviderName:d}=Q(),{map:S,set:N}=F(),{map:P,setWithCallback:D}=F(),H=async($,m)=>{n($,m)},f=async($,m)=>{$.stopPropagation(),D(m,()=>o(m))},{map:M,setWithCallback:I}=F(),{map:k,setWithCallback:O}=F(),[V,X]=z(!1),ce=($,m)=>{$.stopPropagation(),I(m,()=>d(m))},oe=($,m)=>{$.stopPropagation(),O(m,()=>g(m))},de=async $=>{$.stopPropagation(),X(!0);try{await C()}catch{}X(!1)},[T,ue]=z(b.all),ge=()=>[{type:b.all,name:e("all"),count:c().length+r().length},{type:b.proxyProviders,name:e("proxyProviders"),count:c().length},{type:b.proxies,name:e("proxies"),count:r().length}];return(()=>{const $=Be(),m=$.firstChild,me=m.firstChild,R=m.nextSibling;return s(me,l(re,{get each(){return ge()},children:t=>(()=>{const v=Ue(),E=v.firstChild,B=E.nextSibling;return v.$$click=()=>ue(t.type),s(E,()=>t.name),s(B,()=>t.count),G(()=>ae(v,L(T()===t.type&&"tab-active","tab gap-2"))),v})()})),s(m,l(A,{class:"btn btn-circle",get disabled(){return V()},onClick:t=>de(t),get children(){return l(J,{get class(){return L(V()&&"animate-spin text-success")}})}}),null),s(R,l(w,{get when(){return T()===b.all||T()===b.proxyProviders},get children(){return l(ne,{get subChild(){return c().map(t=>{const v=Z(t.proxies.map(a=>a.name)??[],i(),ee()),E=[(()=>{const a=He(),p=a.firstChild,x=p.firstChild,j=x.nextSibling,y=p.nextSibling;return s(x,()=>t.name),s(j,()=>t.proxies.length),s(y,l(A,{class:"btn btn-circle btn-sm mr-2",get disabled(){return k()[t.name]},onClick:W=>oe(W,t.name),get children(){return l(J,{get class(){return L(k()[t.name]&&"animate-spin text-success")}})}}),null),s(y,l(A,{class:"btn btn-circle btn-sm",get disabled(){return M()[t.name]},onClick:W=>ce(W,t.name),get children(){return l(K,{get class(){return L(M()[t.name]&&"animate-pulse text-success")}})}}),null),a})(),l(Ie,{get subscriptionInfo(){return t.subscriptionInfo}}),(()=>{const a=Ae(),p=a.firstChild,x=p.nextSibling;return x.nextSibling,s(a,()=>t.vehicleType,p),s(a,()=>e("updated"),x),s(a,()=>_e(t.updatedAt),null),a})(),l(w,{get when(){return!S()[t.name]},get children(){return l(se,{proxyNameList:v})}})],B=l(le,{proxyNames:v});return l(te,{get isOpen(){return S()[t.name]},title:E,content:B,onCollapse:a=>N(t.name,a)})})}})}}),null),s(R,l(w,{get when(){return T()===b.all},get children(){return Oe()}}),null),s(R,l(w,{get when(){return T()===b.all||T()===b.proxies},get children(){return l(ne,{get subChild(){return r().map(t=>{const v=Z(t.all??[],i(),ee()),E=[(()=>{const a=Fe(),p=a.firstChild,x=p.firstChild,j=x.nextSibling;return s(x,()=>t.name),s(j,()=>{var y;return(y=t.all)==null?void 0:y.length}),s(a,l(A,{class:"btn-circle btn-sm",get disabled(){return P()[t.name]},onClick:y=>f(y,t.name),get children(){return l(K,{get class(){return L(P()[t.name]&&"animate-pulse text-success")}})}}),null),a})(),(()=>{const a=Ge(),p=a.firstChild;return s(a,()=>t.type,p),s(a,()=>{var x;return((x=t.now)==null?void 0:x.length)>0&&` :: ${t.now}`},null),a})(),l(w,{get when(){return!S()[t.name]},get children(){return l(se,{proxyNameList:v,get now(){return t.now}})}})],B=l(le,{proxyNames:v,get now(){return t.now},onClick:a=>{H(t,a)}});return l(te,{get isOpen(){return S()[t.name]},title:E,content:B,onCollapse:a=>N(t.name,a)})})}})}}),null),$})()};ve(["click"]);export{ze as default};
